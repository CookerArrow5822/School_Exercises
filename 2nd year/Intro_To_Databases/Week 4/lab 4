-- lab 4 qs and solutions

-- 1. Return the year and the average wins of the NBA teams after the 1990 season only when this
average is less than 40 (Hint: Group By required)

SELECT year, AVG(won) as avg_wins
FROM teams
WHERE year > 1990
GROUP BY year
HAVING avg_wins < 40


-- 2. Find all the basketball coach IDs with more than 900 of wins, order by ascending number of
losses (Hint: Group By required)

SELECT coachID, SUM(won), sum(lost)
FROM coaches
GROUP BY coachID
HAVING SUM(won) > 900
ORDER BY sum(lost) ASC;

-- 3. Print the players (playerID) of the Miami 1998 team with over 1200 minutes played. Use a
nested query in your answer. (Challenge: Can you display the player names as well?

SELECT DISTINCT playerID
FROM players_teams
WHERE playerID IN (
	SELECT playerID
    FROM players_teams
    WHERE year = 1998
    AND tmID like 'MIA%'
    GROUP BY playerID
    HAVING SUM(minutes) > 1200
);

